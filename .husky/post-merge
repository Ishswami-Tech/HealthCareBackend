#!/bin/sh
# Post-merge hook for Prisma Client regeneration
# This ensures generated files are up-to-date after merging branches

echo "ğŸ”„ Post-merge: Checking Prisma schema changes..."

# Check if schema or config files changed
if git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD | grep -qE "(schema\.prisma|prisma\.config\.js)"; then
  echo "ğŸ“ Prisma schema or config changed, regenerating client..."
  yarn prisma:regenerate || {
    echo "âŒ Failed to regenerate Prisma Client after merge"
    echo "ğŸ’¡ Run 'yarn prisma:regenerate' manually"
    exit 1
  }
  echo "âœ… Prisma Client regenerated successfully"
else
  echo "â„¹ï¸  No Prisma schema changes detected"
fi


#!/bin/sh
# Post-merge hook for Prisma schema formatting
# Prisma Client is generated during Docker build, not in git hooks

echo "ğŸ”„ Post-merge: Checking Prisma schema changes..."

# Check if schema or config files changed
if git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD | grep -qE "(schema\.prisma|prisma\.config\.js)"; then
  echo "ğŸ“ Prisma schema or config changed, formatting schema..."
  # Only format schema, don't regenerate client (handled in Docker build)
  yarn prisma:format || {
    echo "âŒ Failed to format Prisma schema after merge"
    echo "ğŸ’¡ Run 'yarn prisma:format' manually"
    exit 1
  }
  echo "âœ… Prisma schema formatted successfully"
  echo "â„¹ï¸  Prisma Client will be generated during Docker build"
else
  echo "â„¹ï¸  No Prisma schema changes detected"
fi


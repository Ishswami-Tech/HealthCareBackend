apiVersion: v1
kind: ConfigMap
metadata:
  name: openvidu-config
  namespace: healthcare-backend
  labels:
    app: openvidu
    component: config
data:
  # OpenVidu Domain Configuration
  # NOTE: These values are updated dynamically by configure-openvidu-domain.sh script
  # Default values shown below - update via script or manually for your environment
  # Example: If your domain is example.com, set:
  #   OPENVIDU_DOMAIN: "video.example.com"
  #   OPENVIDU_URL: "https://video.example.com"
  # 
  # To update: Run: ./devops/kubernetes/scripts/configure-openvidu-domain.sh <domain>
  
  OPENVIDU_DOMAIN: "video.ishswami.in"
  OPENVIDU_URL: "https://video.ishswami.in"
  
  # OpenVidu Server Configuration
  OPENVIDU_ENABLED: "true"
  OPENVIDU_CDR: "false"
  OPENVIDU_STREAMS_VIDEO_MAX_RECV_BANDWIDTH: "1000"
  OPENVIDU_STREAMS_VIDEO_MIN_RECV_BANDWIDTH: "300"
  OPENVIDU_STREAMS_VIDEO_MAX_SEND_BANDWIDTH: "1000"
  OPENVIDU_STREAMS_VIDEO_MIN_SEND_BANDWIDTH: "300"
  OPENVIDU_STREAMS_FORCED_VIDEO_CODEC: "VP8"
  OPENVIDU_STREAMS_ALLOW_TRANSCODING: "false"
  OPENVIDU_SESSIONS_GARBAGE_INTERVAL: "900"
  OPENVIDU_SESSIONS_GARBAGE_THRESHOLD: "3600"
  
  # Recording Configuration
  OPENVIDU_RECORDING: "true"
  OPENVIDU_RECORDING_PATH: "/opt/openvidu/recordings"
  OPENVIDU_RECORDING_PUBLIC_ACCESS: "false"
  OPENVIDU_RECORDING_NOTIFICATION: "publisher_moderator"
  OPENVIDU_RECORDING_CUSTOM_LAYOUT: "/opt/openvidu/custom-layout"
  OPENVIDU_RECORDING_AUTOSTOP_TIMEOUT: "120"
  OPENVIDU_RECORDING_ALWAYS: "never"
  
  # Webhook Configuration (Optimized Architecture: Webhooks → Backend → Socket.IO)
  # Enable webhooks to reduce Socket.IO load for video events
  # Set OPENVIDU_WEBHOOK_ENDPOINT to your API webhook URL (e.g., https://api.yourdomain.com/api/v1/webhooks/openvidu)
  OPENVIDU_WEBHOOK: "false"
  OPENVIDU_WEBHOOK_ENDPOINT: ""
  OPENVIDU_WEBHOOK_EVENTS: "sessionCreated,sessionDestroyed,participantJoined,participantLeft,recordingStarted,recordingStopped"
  OPENVIDU_WEBHOOK_HEADERS: ""
  OPENVIDU_WEBHOOK_EVENTS_TO_IGNORE: ""
  
  # Timezone
  TZ: "UTC"

